# 磁盘阵列和 ZFS

自从 Unraid 更新到 6.12 新增了对 ZFS 的支持，使用比较鸡肋的校验盘已经没什么必要了。虽然名字是 Unraid，但随着 Unraid 用户群体的扩大，加入 Raid 功能似乎也是早晚的事。这不 6.12 版本，ZFS 就来了！既然使用校验盘会导致写入慢，那就别用校验盘了，如果有 Raid 需求，直接用 ZFS 吧。

尽管可以直接使用 ZFS，但 Unraid 要求默认的磁盘阵列设备里至少要有一块盘，否则阵列无法启动。磁盘阵列第一次启动后创建的四个系统默认的文件夹，也都会保存到磁盘阵列设备里。如果你需要将这四个系统文件夹保存到 ZFS 里，可以在将 ZFS 创建好之后，

## 格式化

设置好阵列之后，点击最下面的 `启动` 按钮，有新盘加入的话，会提示 `格式化`，勾选 `是的，我想这样做` 确认提示，点击 `格式化` 按钮，稍等便会格式化完成，阵列就会建好。

![5ayhbzsa.xp5_3HT1hg](https://img-1255332810.cos.ap-chengdu.myqcloud.com/5ayhbzsa.xp5_3HT1hg.png)


## 重置阵列

当你需要向阵列中添加新盘，先停止阵列，直接选择新盘再启动就可以，加盘不需要重置阵列！

当你需要从阵列中移除掉某块磁盘时，需要重置阵列。重置不会影响数据，但你最好提前确认下，移除的这块盘里没有什么重要数据，如果有的话，可以提前先把数据转移到别的盘上再从阵列中移除。

如果你没有重置阵列，直接关机把盘从阵列中拿出来，下次启动的时候也会直接提示 `缺少磁盘`。

![sulnw1fa.l4y_bRJLbc](https://img-1255332810.cos.ap-chengdu.myqcloud.com/sulnw1fa.l4y_bRJLbc.png)

重置阵列在 `工具` -> `新配置` 中按下图操作：

![yspp5dbz.1y2_p2CBbG](https://img-1255332810.cos.ap-chengdu.myqcloud.com/yspp5dbz.1y2_p2CBbG.png)

重置之后，磁盘阵列就和新的一样，你可以按之前的设置，把现有的磁盘都加回来再启动就行了。

需要注意的是，重置之后，磁盘 `自动启动` 和 `休眠` 都会恢复到默认关闭状态，如果需要可以重新设置。

![2szluszr.ewq_Vgfry4](https://img-1255332810.cos.ap-chengdu.myqcloud.com/2szluszr.ewq_Vgfry4.png)

另外有部分共享文件夹的设置可能会因为重置阵列而受到影响，需要你自己确认下，比如 `新文件和文件夹的主存储空间`，`包含的磁盘`，`已排除的磁盘` 这几个设置。

![HbVpkp_s83htT](https://img-1255332810.cos.ap-chengdu.myqcloud.com/HbVpkp_s83htT.png)