import{_ as a,c as i,a2 as p,o as n}from"./chunks/framework.eme8ZeBJ.js";const r=JSON.parse('{"title":"fnOS 配置 UPS","description":"","frontmatter":{},"headers":[],"relativePath":"fnos/ups.md","filePath":"fnos/ups.md","lastUpdated":null}'),t={name:"fnos/ups.md"};function e(l,s,h,d,k,c){return n(),i("div",null,s[0]||(s[0]=[p(`<h1 id="fnos-配置-ups" tabindex="-1">fnOS 配置 UPS <a class="header-anchor" href="#fnos-配置-ups" aria-label="Permalink to &quot;fnOS 配置 UPS&quot;">​</a></h1><p><img src="https://img.slarker.me/wiki/power.webp" alt=""></p><p>尽管 fnOS 目前官方不支持 UPS，不过 fnOS 基于 <code>Debian</code> 开发，如果想使用 UPS，也非常简单，可以通过 <code>ssh</code> 命令行配置。</p><p>以我使用的山特 TG-Box 850 为例，将 UPS 的 USB 信号线插到 NAS 的 USB 接口。<a href="/fnos/ssh.html">使用 SSH 登录</a> fnOS，并切换到 <code>root</code> 用户，依次执行下面的命令。</p><h2 id="安装-apcupsd" tabindex="-1">安装 apcupsd <a class="header-anchor" href="#安装-apcupsd" aria-label="Permalink to &quot;安装 apcupsd&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">Tips</p><p>Apcupsd 是一款功能强大的软件，专门用于监控不间断电源（UPS）系统。</p></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 更新 apt 源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 apcupsd，期间会提示操作会占用一定空间，输入 Y 确认</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apcupsd</span></span></code></pre></div><h2 id="编辑-ups-配置" tabindex="-1">编辑 UPS 配置 <a class="header-anchor" href="#编辑-ups-配置" aria-label="Permalink to &quot;编辑 UPS 配置&quot;">​</a></h2><p>apcupsd 的配置文件在 <code>/etc/apcupsd/apcupsd.conf</code>，可以使用 <code>nano</code> 编辑器打开文件：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apcupsd/apcupsd.conf</span></span></code></pre></div><p>具体要修改的配置如下：</p><div class="info custom-block"><p class="custom-block-title">提示</p><ul><li>Linux 的配置文件中，如果该行前面有 <code>#</code>，表示注释，可以忽略。如果需要让本行配置生效，需要删除 <code>#</code>。</li><li>由于配置项比较多，需要修改的配置仅有下面几项，找到需要修改的配置所在的行，修改即可。其它没有提到的配置，无须修改，保持默认。</li></ul></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除 UPSNAME 前面的 #，可以改成自己的 UPS 型号，比如 \`tg-box850\`。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UPSNAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tg-box850</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除 POLLTIME 名称前面的 #，POLLTIME 表示检测 ups 状态的间隔时间，默认 60 秒</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">POLLTIME</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意</p><p>以下三个设置中只要有一个满足，自动关机就会被触发</p></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># UPS 剩余电量低于 80%，开始自动关机，默认为 5，可以改成 80。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BATTERYLEVEL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># UPS 剩余电量不超过 3 分钟，开始自动关机</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MINUTES</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 市电中断超过 60 秒后，开始自动关机，默认为 0，可以改成 60。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TIMEOUT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span></span></code></pre></div><p>修改完成之后，<code>Ctrl+X</code>，输入 <code>Y</code>，回车确认退出。</p><h2 id="配置服务" tabindex="-1">配置服务 <a class="header-anchor" href="#配置服务" aria-label="Permalink to &quot;配置服务&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apcupsd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置开机自启服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apcupsd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apcupsd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看服务状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apcupsd</span></span></code></pre></div><p><img src="https://img.slarker.me/wiki/Snipaste_2024-09-14_21-53-30.webp" alt=""></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看 UPS 状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apcaccess</span></span></code></pre></div><p>配置成功如图所示：</p><p><img src="https://img.slarker.me/wiki/Snipaste_2024-09-14_21-50-05.webp" alt=""></p>`,22)]))}const g=a(t,[["render",e]]);export{r as __pageData,g as default};
