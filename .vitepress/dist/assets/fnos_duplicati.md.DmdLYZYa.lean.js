import{_ as i,c as a,a2 as p,o as t}from"./chunks/framework.eme8ZeBJ.js";const o=JSON.parse('{"title":"支持加密的备份工具 - Duplicati","description":"","frontmatter":{},"headers":[],"relativePath":"fnos/duplicati.md","filePath":"fnos/duplicati.md","lastUpdated":1726842560000}'),n={name:"fnos/duplicati.md"};function e(l,s,h,k,c,d){return t(),a("div",null,s[0]||(s[0]=[p(`<h1 id="支持加密的备份工具-duplicati" tabindex="-1">支持加密的备份工具 - Duplicati <a class="header-anchor" href="#支持加密的备份工具-duplicati" aria-label="Permalink to &quot;支持加密的备份工具 - Duplicati&quot;">​</a></h1><p>之前我介绍过 <a href="/unraid/duplicati.html">在 Unraid 中安装使用 Duplicati</a>，我也一直用这个工具来备份重要的数据。</p><p><img src="https://img.slarker.me/wiki/202409202046557.webp" alt=""></p><p>fnOS 自带了备份工具，但是目前仍然缺少一些重要的功能，比如想把重要资料备份到网盘，但备份工具不支持加密。而上次我介绍的 Duplicati 就支持备份加密，这篇就介绍如何在 fnOS 中安装 Duplicati。</p><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><p>Duplicati 不仅有 Docker 版，还支持主流的 Linux，Windows 等平台，比如 <code>Debian/Ubuntu</code> 就有 deb 安装包，相比使用 Docker，在系统里直接安装无须添加路径映射，Duplicati 直接就可以读取到系统里的所有文件，也很少会产生权限问题，会方便不少。而 fnOS 基于 Debian，所以可以直接在 Debian 中安装。</p><p><a href="/fnos/ssh.html">使用 SSH 登录</a> fnOS，并切换到 <code>root</code> 用户，粘贴执行下面的命令：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 更新系统</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 下载 Duplicati deb 安装包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://updates.duplicati.com/beta/duplicati_2.0.8.1-1_all.deb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 Duplicati，此时会提示缺少依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duplicati_2.0.8.1-1_all.deb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --fix-broken</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 再次安装 Duplicati</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duplicati_2.0.8.1-1_all.deb</span></span></code></pre></div><p>Duplicati 默认仅允许本机（localhost）访问，需要对配置文件 <code>/etc/default/duplicati</code> 做一点点修改：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 nano 编辑配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/default/duplicati</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 把配置文件中的 DAEMON_OPTS 所在的行替换成下面这行内容。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># webservice-interface 参数为 any 表示任意接口都可以访问 duplicati 服务。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># webservice-port 参数为 8200，表示 Web 服务访问端口，如果需要改成其他端口，可以在这里修改。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DAEMON_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--webservice-interface=any --webservice-port=8200 --portable-mode&quot;</span></span></code></pre></div><p>修改完成，应该像下面这样：</p><p><img src="https://img.slarker.me/wiki/202409202128689.webp" alt=""></p><p>编辑完成按 <code>Ctrl+X</code>，输入 <code>Y</code> 确认，回车退出。接下来配置 Duplicati 服务：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duplicati.service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开机启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duplicati.service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看服务状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duplicati.service</span></span></code></pre></div><p><img src="https://img.slarker.me/wiki/202409202127788.webp" alt=""></p><p>Duplicati 默认端口是 <code>8200</code>，使用 <code>fnOS IP:8200</code> 就可以访问了。</p><h2 id="备份" tabindex="-1">备份 <a class="header-anchor" href="#备份" aria-label="Permalink to &quot;备份&quot;">​</a></h2><p>新增备份，可以选择加密。整体流程非常简单明了，一路下一步就行了。</p><p><img src="https://img.slarker.me/wiki/kcc2wyry.jtd.webp" alt=""></p><p>备份保存位置，这里可以直接看到 fnOS 里的所有文件夹，这里我选 NAS 上的另一个存储池上的 <code>backup</code> 文件夹。</p><p><img src="https://img.slarker.me/wiki/km50zsmv.e0k.webp" alt=""></p><p>支持的备份位置也比较多，包括 S3，对象存储（国内的阿里云 OSS，腾讯云 COS 等），以及好用的 <code>webdav</code> 等等。</p><p><img src="https://img.slarker.me/wiki/202409202148556.webp" alt=""></p><p>源数据，选择需要备份的源数据文件夹。</p><p><img src="https://img.slarker.me/wiki/p0gj5qsh.fhv.webp" alt=""></p><p>支持备份计划。</p><p><img src="https://img.slarker.me/wiki/5zll2frn.4mm.webp" alt=""></p><p>设置完成之后，可以点 <code>立即运行</code>，试试效果。</p><p><img src="https://img.slarker.me/wiki/cutjqfz4.ql0.webp" alt=""></p><p>备份完成后，在备份位置可以看到加密过的备份文件。</p><p><img src="https://img.slarker.me/wiki/202409202145448.webp" alt=""></p>`,31)]))}const g=i(n,[["render",e]]);export{o as __pageData,g as default};
