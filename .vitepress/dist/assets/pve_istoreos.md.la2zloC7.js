import{_ as a,c as i,a2 as c,o}from"./chunks/framework.eme8ZeBJ.js";const b=JSON.parse('{"title":"虚拟 iStoreOS 旁路由","description":"","frontmatter":{},"headers":[],"relativePath":"pve/istoreos.md","filePath":"pve/istoreos.md","lastUpdated":1731991065000}'),d={name:"pve/istoreos.md"};function s(t,e,p,r,l,m){return o(),i("div",null,e[0]||(e[0]=[c(`<h1 id="虚拟-istoreos-旁路由" tabindex="-1">虚拟 iStoreOS 旁路由 <a class="header-anchor" href="#虚拟-istoreos-旁路由" aria-label="Permalink to &quot;虚拟 iStoreOS 旁路由&quot;">​</a></h1><p>旁路由在逻辑上和你网络中的 PC，手机没有区别，都是网络中的一个普通设备，仅仅是多了一个流量转发的功能。网络中的其他设备如果需要使用，只需要将设备 IP 设置为静态，把 <code>网关</code> 和 <code>DNS</code> 指向旁路由的 IP 即可。</p><p>旁路由对网口数量没有要求，只需要设备有一个网口就可以。下面就介绍如何在 PVE 中虚拟 iStoreOS 作为旁路由。</p><h2 id="istoreos-镜像" tabindex="-1">iStoreOS 镜像 <a class="header-anchor" href="#istoreos-镜像" aria-label="Permalink to &quot;iStoreOS 镜像&quot;">​</a></h2><p>iStoreOS 镜像你可以在 <a href="https://fw.koolcenter.com/iStoreOS/x86_64/" target="_blank" rel="noreferrer">官网下载</a> 并解压得到 <code>img</code> 文件。为了减少出错，解压后可以重命名为 <code>istoreos.img</code>。</p><p>在 PVE 的 <code>ISO 镜像</code> 中上传 iStoreOS 的镜像 <code>istoreos.img</code>。</p><p><img src="https://img.slarker.me/wiki/8cfae25a132a4fc5833f63cecd2fc08b.webp" alt=""></p><h2 id="建立虚拟机" tabindex="-1">建立虚拟机 <a class="header-anchor" href="#建立虚拟机" aria-label="Permalink to &quot;建立虚拟机&quot;">​</a></h2><p>在 PVE 中创建虚拟机，名称自己填写，注意这里有个 <code>VM ID</code>，是该虚拟机的唯一 <code>ID</code> 标识（默认 PVE 会自动分配，不需要修改），后续在 PVE 的 <code>shell</code> 终端中可以使用命令通过该 <code>ID</code> 操作虚拟机。</p><p><img src="https://img.slarker.me/wiki/61df2727689e4b97827cf2c0704e78d5.webp" alt=""></p><p>选择 <code>不使用任何介质</code>。</p><p><img src="https://img.slarker.me/wiki/8722403cbba247e594c78c7a8eed83ac.webp" alt=""></p><p>系统 BIOS 选择 <code>q35</code>。</p><p><img src="https://img.slarker.me/wiki/2d3e73f99daf4a08b8b32d90e33cd45b.webp" alt=""></p><p>删除默认的磁盘。</p><p><img src="https://img.slarker.me/wiki/fe7d94948c4548ea9c24addcadddde85.webp" alt=""></p><p>CPU 核心可以设置为 <code>2</code>，类别一般选择 <code>host</code>。</p><p><img src="https://img.slarker.me/wiki/71cf2d75610245b5a1cb3f9ff07821c0.webp" alt=""></p><p>内存选择 <code>1024</code>，也就是 <code>1GB</code>。</p><p><img src="https://img.slarker.me/wiki/4c022e741f3f49af8d30994fd8df51a8.webp" alt=""></p><p>网络保持默认。</p><p><img src="https://img.slarker.me/wiki/a5d129dfad3a4140b028838c1d207478.webp" alt=""></p><p>确认没问题，点击完成。</p><p><img src="https://img.slarker.me/wiki/573e913a30d0441ab91be4c96d003be0.webp" alt=""></p><p>在 PVE 的 <code>shell</code> 终端中使用命令导入 iStoreOS 镜像：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 104 为 iStoreOSTest 虚拟机的 ID。末尾的 local 为虚拟机的存储空间，如果你的 PVE 没有将 local-lvm 合并到 local，那么末尾应该为 local-lvm。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> importdisk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 104</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/vz/template/iso/istoreos.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span></span></code></pre></div><p><img src="https://img.slarker.me/wiki/f3da02dfcfc94b3daa853c29f623600d.webp" alt=""></p><p>在 iStoreOSTest 虚拟机的 <code>硬件</code> 中双击 <code>未使用的磁盘 0</code>，将总线设备修改为 <code>SATA</code>，点击 <code>添加</code>。</p><p><img src="https://img.slarker.me/wiki/1c9dadf2d8d44008af3b74ce64edeb5e.webp" alt=""></p><p>在 iStoreOSTest 虚拟机的 <code>选项</code> 中双击 <code>引导顺序</code>，仅将 <code>sata0</code> 保持勾选，并移动到第一个引导顺序，点击 <code>OK</code>。</p><p><img src="https://img.slarker.me/wiki/8571128ecf3e46ca8ed9252d424d1e2d.webp" alt=""></p><p>之后启动 iStoreOSTest 虚拟机，在你的主路由中查找名为 <code>iStoreOS</code> 的设备，使用浏览器打开该 IP。默认用户名/密码：root/password。</p><p><img src="https://img.slarker.me/wiki/9290b8f0f115411b9ad3bc64d8547c4c.webp" alt=""></p><p>登录后点击首页的 <code>网络向导</code>，点击 <code>配置为旁路由</code>。</p><p><img src="https://img.slarker.me/wiki/91eaaa3983d54718863a6b066bf2d5f0.webp" alt=""></p><p>点击 <code>自动配置</code>。</p><p><img src="https://img.slarker.me/wiki/af0a4c21344249e1ba2b955feeea252b.webp" alt=""></p><p>点击灰色的 <code>当前 IPV4 上游信息（点此刷新）</code>，会自动从主路由获取相关信息，之后点击 <code>自动填写</code>。</p><p><img src="https://img.slarker.me/wiki/64dc189c740643429d96f06cabbfa21f.webp" alt=""></p><p>确认 IP 地址，网关地址，DNS 服务器都正常，关闭 <code>提供 DHCPv4 服务</code>，打开 <code>开启 NAT</code>，点击 <code>保存配置</code>。</p><p><img src="https://img.slarker.me/wiki/996fd5f265c14649bd4d9f61020236b1.webp" alt=""></p><p>到这里就配置成功了，点击 <code>进入控制台</code>。</p><p><img src="https://img.slarker.me/wiki/0b9ea5d43fde42f4b2c05869f302d917.webp" alt=""></p><h2 id="使用旁路由" tabindex="-1">使用旁路由 <a class="header-anchor" href="#使用旁路由" aria-label="Permalink to &quot;使用旁路由&quot;">​</a></h2><p>上面创建的 iStoreOSTest 旁路由的 IP 为 <code>192.168.2.186</code>。以 fnOS 为例，设置 fnOS 通过旁路由上网。</p><p>在 fnOS 的 <code>网络设置</code> 中，手动设置 <code>IPv4</code> 为静态 IP，并将 <code>网关地址</code> 和 <code>DNS</code> 设置为 <code>旁路由的 IP</code>。</p><p><img src="https://img.slarker.me/wiki/1536e93bc814445bb9fcc05719cb1ff6.webp" alt=""></p>`,47)]))}const k=a(d,[["render",s]]);export{b as __pageData,k as default};
