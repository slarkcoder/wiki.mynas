# 家庭组网的几个建议

![pexels-field-engineer-147254-442154_chVhoT](https://img-1255332810.cos.ap-chengdu.myqcloud.com/pexels-field-engineer-147254-442154_chVhoT.jpg)

## 网络扁平化

尽可能将网络扁平化，减少网络层级，降低网络复杂度。我用下面这张图来解释什么是扁平化：

![网络扁平化.drawio_F7nufI](https://img-1255332810.cos.ap-chengdu.myqcloud.com/网络扁平化.drawio_F7nufI.svg)

- 图 1 网络只有一个网段，所有的联网设备都处在同一个网段，设备之间都可以互相访问。
- 图 2 网络存在三个网段，容易出现设备之间无法互相访问。

## 静态 IP 和 DHCP

如果你的网络里设备比较多，并且同时存在静态 IP 和 DHCP，那么 IP 冲突是很常见的问题，而且出现 IP 冲突时的现象也比较诡异。

对于 NAS 之类需要经常通过 IP 去访问的设备，强烈建议设置静态 IP，可以避免由于 DHCP 导致 IP 变化无法访问。并且最好在主路由将 DHCP 分配的范围和静态 IP 隔开，能有效避免 IP 冲突。

比如，我的主路由为 `192.168.2.1`，NAS 设置了固定的 IP 为 `192.168.2.100`，那么主路由的 DHCP 分配范围可以设置为 `192.168.2.101` 到 `192.168.2.254`。

## 网络测速

网络设置好之后，可以利用 软路由、NAS 上的内网测速工具，比如在各个房间的 PC 上使用 `HomeBox`、`OpenSpeedTest`、`iperf3` 等工具来测试家里的网络速度是否存在异常。

- 如果在 PC 端使用有线网络测试，那至少应该跑满千兆。
- 如果具备 2.5G 网络条件（测速两端都为 2.5G 网口），那应该跑满 2.5Gbps。
- 如果具备 10G（万兆）网络条件（测速两端都为 10Gbps 网口），那应该接近跑满 10Gbps。

## FTTR 和软路由

现在很多地方的运营商都提供全屋光纤组网（FTTR），搭配运营商提供的子母路由实现全屋覆盖。如果你想使用软路由作为主路由，那我建议慎重选择 FTTR 方案。

软路由作为主路由，需要部署在家庭网络入口位置，正常来讲，需要把子母路由接到软路由下面，但 FTTR 不支持这么做。如果你已经使用了 FTTR，可以搭配旁路由来使用。